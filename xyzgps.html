<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>í˜„ì¥ ì¢Œí‘œ ë³€í™˜ê¸°</title>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

<!-- ì¹´ì¹´ì˜¤ ì§€ë„ -->
<script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=ff9e145029506d6e4c72d1f2b01ea424&libraries=services"></script>

<!-- proj4 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.9.0/proj4.js"></script>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  padding-bottom:110px;
  font-family:system-ui,Arial;
  background:#0f172a;
  color:#fff;
}
.header{
  padding:14px;
  text-align:center;
  font-size:18px;
  font-weight:700;
  background:#020617;
}
.card{
  background:#020617;
  border-radius:16px;
  padding:14px;
  margin:12px;
}
select,input{
  width:100%;
  min-height:56px;
  padding:18px;
  margin-top:10px;
  font-size:18px;
  border-radius:14px;
  border:none;
  background:#1e293b;
  color:#fff;
}
pre{
  white-space:pre-wrap;
  line-height:1.6;
  font-size:15px;
  background:#020617;
  border:1px solid #1e293b;
  border-radius:14px;
  padding:14px;
}
#map{
  height:240px;
  margin:12px;
  border-radius:16px;
  overflow:hidden;
}
.action-bar{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:#020617;
  display:flex;
  gap:10px;
  padding:10px;
}
.action-bar button{
  flex:1;
  padding:18px;
  font-size:17px;
  font-weight:700;
  border:none;
  border-radius:16px;
}
.primary{background:linear-gradient(135deg,#22c55e,#16a34a);color:#020617}
.secondary{background:#334155;color:#fff}
</style>
</head>

<body>

<div class="header">ğŸ†˜ í˜„ì¥ ì¢Œí‘œ ë³€í™˜ê¸°</div>

<!-- ìœ„ë„/ê²½ë„ ì…ë ¥ -->
<div class="card">
  <select id="mode">
    <option value="dd">ë„ì¢Œí‘œ ì…ë ¥</option>
    <option value="dms">ë„ë¶„ì´ˆ ì…ë ¥</option>
  </select>
  <input id="lat" placeholder="ìœ„ë„ (35.131486 / 35 7 53.35)">
  <input id="lon" placeholder="ê²½ë„ (126.947881 / 126 56 52.37)">
</div>

<!-- êµ­ê°€ì§€ì ë²ˆí˜¸ ì…ë ¥ -->
<div class="card">
  <input id="np" placeholder="êµ­ê°€ì§€ì ë²ˆí˜¸ ì…ë ¥ (ì˜ˆ: 960ê°€ 1940ë‹¤ / 960 1940)">
</div>

<div class="card">
  <pre id="result">ì¢Œí‘œ ì…ë ¥ í›„ ë³€í™˜ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”</pre>
</div>

<div id="map"></div>

<div class="action-bar">
  <button class="primary" onclick="convertFromLatLon()">ğŸ“ ì¢Œí‘œ ë³€í™˜</button>
  <button class="secondary" onclick="convertFromNational()">ğŸ”ï¸ êµ­ê°€ì§€ì ë²ˆí˜¸ ë³€í™˜</button>
</div>

<script>
/* ===== EPSG ===== */
proj4.defs("EPSG:5179",
"+proj=tmerc +lat_0=38 +lon_0=127.5 +k=0.9996 +x_0=1000000 +y_0=2000000 +ellps=GRS80 +units=m +no_defs");

/* ===== ìœ í‹¸ ===== */
function dmsToDecimal(v){
  const p=v.trim().split(/\s+/).map(Number);
  return p[0]+p[1]/60+p[2]/3600;
}
function toDMS(deg){
  const d=Math.floor(deg);
  const m=Math.floor((deg-d)*60);
  const s=(((deg-d)*60-m)*60).toFixed(2);
  return `${d}Â° ${m}â€² ${s}â€³`;
}
function nationalPoint(x,y){
  return `${Math.floor(x/100)} ${Math.floor(y/100)}`;
}

/* ===== í•œê¸€ ë§¤í•‘ ===== */
const xHangul={ê°€:7,ë‚˜:8,ë‹¤:9,ë¼:10,ë§ˆ:11,ë°”:12,ì‚¬:13};
const yHangul={ê°€:13,ë‚˜:14,ë‹¤:15,ë¼:16,ë§ˆ:17,ë°”:18,ì‚¬:19,ì•„:20};

/* ===== ì§€ë„ ===== */
let map,marker;
function showMap(lat,lon){
  const pos=new kakao.maps.LatLng(lat,lon);
  map=new kakao.maps.Map(document.getElementById('map'),{center:pos,level:3});
  marker=new kakao.maps.Marker({position:pos});
  marker.setMap(map);
}

/* ===== ìœ„ë„/ê²½ë„ â†’ ì „ì²´ ===== */
function convertFromLatLon(){
  let lat,lon;
  if(mode.value==="dd"){
    lat=parseFloat(latInput.value);
    lon=parseFloat(lonInput.value);
  }else{
    lat=dmsToDecimal(latInput.value);
    lon=dmsToDecimal(lonInput.value);
  }
  if(isNaN(lat)||isNaN(lon)){
    alert("ì¢Œí‘œë¥¼ ì •í™•íˆ ì…ë ¥í•˜ì„¸ìš”");
    return;
  }

  const utm=proj4("WGS84","EPSG:5179",[lon,lat]);
  const x=Math.floor(utm[0]);
  const y=Math.floor(utm[1]);

  result.textContent=
`ğŸ“Œ WGS84
DD : ${lat.toFixed(6)}, ${lon.toFixed(6)}
DMS: ${toDMS(lat)} N / ${toDMS(lon)} E

ğŸ§­ UTM-K (EPSG:5179)
E ${x}
N ${y}

ğŸ”ï¸ êµ­ê°€ì§€ì ë²ˆí˜¸
${nationalPoint(x,y)}
`;
  showMap(lat,lon);
}

/* ===== êµ­ê°€ì§€ì ë²ˆí˜¸ â†’ ì¢Œí‘œ ===== */
function convertFromNational(){
  const input=np.value.replace(/\s+/g,'');
  const nums=input.match(/\d+/g);
  const hanguls=input.match(/[ê°€-ì•„]/g)||[];

  if(!nums||nums.length!==2){
    alert("êµ­ê°€ì§€ì ë²ˆí˜¸ í˜•ì‹ ì˜¤ë¥˜");
    return;
  }

  let xBase=0,yBase=0;
  hanguls.forEach(h=>{
    if(xHangul[h]) xBase=xHangul[h]*100000;
    if(yHangul[h]) yBase=yHangul[h]*100000;
  });

  const x=xBase+Number(nums[0])*100;
  const y=yBase+Number(nums[1])*100;

  const wgs=proj4("EPSG:5179","WGS84",[x,y]);
  const lon=wgs[0], lat=wgs[1];

  result.textContent=
`ğŸ”ï¸ êµ­ê°€ì§€ì ë²ˆí˜¸
${np.value}

ğŸ§­ UTM-K (EPSG:5179)
E ${Math.floor(x)}
N ${Math.floor(y)}

ğŸ“Œ WGS84
DD : ${lat.toFixed(6)}, ${lon.toFixed(6)}
DMS: ${toDMS(lat)} N / ${toDMS(lon)} E
`;
  showMap(lat,lon);
}

/* DOM */
const latInput=document.getElementById("lat");
const lonInput=document.getElementById("lon");
const mode=document.getElementById("mode");
const np=document.getElementById("np");
const result=document.getElementById("result");
</script>

</body>
</html>
