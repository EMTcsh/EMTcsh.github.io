<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>í˜„ì¥ ì¢Œí‘œ ë³€í™˜ê¸°</title>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

<!-- ì¹´ì¹´ì˜¤ ì§€ë„ -->
<script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=ff9e145029506d6e4c72d1f2b01ea424&libraries=services"></script>

<style>
*{
  box-sizing:border-box; /* â­ ì „ì²´ ë°•ìŠ¤ ê³„ì‚° ì•ˆì •í™” */
}

body{
  margin:0;
  padding-bottom:100px; /* í•˜ë‹¨ ì•¡ì…˜ë°” ê³µê°„ */
  font-family:system-ui, -apple-system, Arial;
  background:#0f172a;
  color:#fff;
}

/* ìƒë‹¨ */
.header{
  padding:14px;
  text-align:center;
  font-size:18px;
  font-weight:700;
  background:#020617;
}

/* ì¹´ë“œ */
.card{
  background:#020617;
  border-radius:16px;
  padding:14px;
  margin:12px;
}

/* ì…ë ¥ */
select,
input{
  width:100%;
  min-height:56px;        /* â­ í„°ì¹˜ ì˜ì—­ í™•ë³´ */
  padding:18px;
  margin-top:10px;
  font-size:18px;
  border-radius:14px;
  border:none;
  background:#1e293b;
  color:#fff;
}

/* ê²°ê³¼ */
pre{
  white-space:pre-wrap;
  line-height:1.6;
  font-size:15px;
  background:#020617;
  border:1px solid #1e293b;
  border-radius:14px;
  padding:14px;
}

/* ì§€ë„ */
#map{
  height:240px;
  margin:12px;
  border-radius:16px;
  overflow:hidden;
}

/* í•˜ë‹¨ ì•¡ì…˜ë°” */
.action-bar{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:#020617;
  display:flex;
  gap:10px;
  padding:10px;
  box-shadow:0 -4px 10px rgba(0,0,0,0.4);
}
.action-bar button{
  flex:1;
  padding:18px;
  font-size:18px;
  font-weight:700;
  border:none;
  border-radius:16px;
  background:linear-gradient(135deg,#22c55e,#16a34a);
  color:#020617;
}
.action-bar button.secondary{
  background:#334155;
  color:#fff;
}
</style>
</head>

<body>

<div class="header">ğŸ†˜ í˜„ì¥ ì¢Œí‘œ ë³€í™˜ê¸°</div>

<div class="card">
  <select id="mode">
    <option value="dd">ë„ì¢Œí‘œ ì…ë ¥</option>
    <option value="dms">ë„ë¶„ì´ˆ ì…ë ¥</option>
  </select>

  <input id="lat" inputmode="decimal" placeholder="ìœ„ë„ (35.131486 / 35 7 53.35)">
  <input id="lon" inputmode="decimal" placeholder="ê²½ë„ (126.947881 / 126 56 52.37)">
</div>

<div class="card">
  <pre id="result">ì¢Œí‘œë¥¼ ì…ë ¥í•˜ê³  í•˜ë‹¨ [ë³€í™˜]ì„ ëˆ„ë¥´ì„¸ìš”</pre>
</div>

<div id="map"></div>

<div class="action-bar">
  <button onclick="convert()">ğŸ“ ë³€í™˜</button>
  <button class="secondary" onclick="copyResult()">ğŸ“‹ ë³µì‚¬</button>
  <button class="secondary" onclick="shareResult()">ğŸ“¤ ê³µìœ </button>
</div>

<script>
/* ===== ë„ë¶„ì´ˆ â†’ ë„ ===== */
function dmsToDecimal(v){
  const p=v.trim().split(/\s+/).map(Number);
  return p[0]+p[1]/60+p[2]/3600;
}

/* ===== ë„ â†’ ë„ë¶„ì´ˆ ===== */
function toDMS(deg){
  const d=Math.floor(deg);
  const mFloat=(deg-d)*60;
  const m=Math.floor(mFloat);
  const s=((mFloat-m)*60).toFixed(2);
  return `${d}Â° ${m}â€² ${s}â€³`;
}

/* ===== WGS84 â†’ TM (ê°„ì´) ===== */
function wgs84ToTM(lat,lon){
  const a=6378137;
  const f=1/298.257222101;
  const lon0=127*Math.PI/180;

  const e2=2*f-f*f;
  const latR=lat*Math.PI/180;
  const lonR=lon*Math.PI/180;

  const N=a/Math.sqrt(1-e2*Math.sin(latR)**2);
  const A=(lonR-lon0)*Math.cos(latR);

  return{
    x:Math.floor(N*A+200000),
    y:Math.floor(N*Math.log(Math.tan(Math.PI/4+latR/2))+500000)
  };
}

/* ===== êµ­ê°€ì§€ì ë²ˆí˜¸ ===== */
function nationalPoint(tm){
  return `${Math.floor(tm.x/100)} ${Math.floor(tm.y/100)}`;
}

/* ===== ì§€ë„ ===== */
let map,marker;
function showMap(lat,lon){
  map=new kakao.maps.Map(document.getElementById('map'),{
    center:new kakao.maps.LatLng(lat,lon),
    level:3
  });
  marker=new kakao.maps.Marker({
    position:new kakao.maps.LatLng(lat,lon)
  });
  marker.setMap(map);
}

/* ===== ë³€í™˜ ===== */
function convert(){
  let lat,lon;
  if(mode.value==="dd"){
    lat=parseFloat(latInput.value);
    lon=parseFloat(lonInput.value);
  }else{
    lat=dmsToDecimal(latInput.value);
    lon=dmsToDecimal(lonInput.value);
  }

  if(isNaN(lat)||isNaN(lon)){
    alert("ì¢Œí‘œë¥¼ ì •í™•íˆ ì…ë ¥í•˜ì„¸ìš”");
    return;
  }

  const tm=wgs84ToTM(lat,lon);

  result.textContent=
`ğŸ“ ë„ë¶„ì´ˆ
${toDMS(lat)} N
${toDMS(lon)} E

ğŸ—ºï¸ TM ì¢Œí‘œ
X ${tm.x}
Y ${tm.y}

ğŸ”ï¸ êµ­ê°€ì§€ì ë²ˆí˜¸
${nationalPoint(tm)}
`;

  navigator.vibrate?.([80,40,80]);
  showMap(lat,lon);
}

/* ===== ë³µì‚¬ ===== */
function copyResult(){
  navigator.clipboard.writeText(result.textContent);
  navigator.vibrate?.(100);
  alert("ì¢Œí‘œ ë³µì‚¬ ì™„ë£Œ");
}

/* ===== ê³µìœ  ===== */
function shareResult(){
  if(navigator.share){
    navigator.share({
      title:"í˜„ì¥ ì¢Œí‘œ",
      text:result.textContent
    });
  }else{
    copyResult();
  }
}

const latInput=document.getElementById("lat");
const lonInput=document.getElementById("lon");
const mode=document.getElementById("mode");
const result=document.getElementById("result");
</script>

</body>
</html>
