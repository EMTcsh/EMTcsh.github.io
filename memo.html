<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ğŸ†˜ í˜„ì¥ ì¢Œí‘œ ë³€í™˜ê¸°</title>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

<!-- Kakao Map -->
<script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=YOUR_KAKAO_KEY"></script>

<!-- proj4 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.9.0/proj4.js"></script>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  padding-bottom:100px;
  font-family:system-ui,Arial;
  background:#0f172a;
  color:#fff;
}
.header{
  padding:14px;
  text-align:center;
  font-size:18px;
  font-weight:700;
  background:#020617;
}
.card{
  background:#020617;
  border-radius:16px;
  padding:14px;
  margin:12px;
}
input{
  width:100%;
  min-height:56px;
  padding:18px;
  font-size:18px;
  border-radius:14px;
  border:none;
  background:#1e293b;
  color:#fff;
}
pre{
  white-space:pre-wrap;
  line-height:1.6;
  font-size:15px;
  background:#020617;
  border:1px solid #1e293b;
  border-radius:14px;
  padding:14px;
}
#map{
  height:240px;
  margin:12px;
  border-radius:16px;
}
.action-bar{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  display:flex;
  gap:10px;
  padding:10px;
  background:#020617;
}
button{
  flex:1;
  padding:18px;
  font-size:18px;
  font-weight:700;
  border:none;
  border-radius:16px;
}
.primary{background:linear-gradient(135deg,#22c55e,#16a34a);color:#020617}
.secondary{background:#334155;color:#fff}
</style>
</head>

<body>

<div class="header">ğŸ†˜ í˜„ì¥ ì¢Œí‘œ ë³€í™˜ê¸°</div>

<div class="card">
  <input id="input" placeholder="ìœ„ê²½ë„ / ë„ë¶„ì´ˆ / êµ­ê°€ì§€ì ë²ˆí˜¸ (ì˜ˆ: ê°€ 34567 ë‚˜ 123456)">
</div>

<div class="card">
  <pre id="result">ì¢Œí‘œ ì…ë ¥ í›„ [ë³€í™˜]ì„ ëˆ„ë¥´ì„¸ìš”</pre>
</div>

<div id="map"></div>

<div class="action-bar">
  <button class="primary" onclick="convert()">ğŸ“ ë³€í™˜</button>
  <button class="secondary" onclick="copyResult()">ğŸ“‹ ë³µì‚¬</button>
  <button class="secondary" onclick="shareResult()">ğŸ“¤ ê³µìœ </button>
</div>

<script>
/* EPSG */
proj4.defs("EPSG:5179",
"+proj=tmerc +lat_0=38 +lon_0=127.5 +k=0.9996 +x_0=1000000 +y_0=2000000 +ellps=GRS80 +units=m +no_defs");

/* í•œê¸€ ë§¤í•‘ */
const xKor={7:'ê°€',8:'ë‚˜',9:'ë‹¤',10:'ë¼',11:'ë§ˆ',12:'ë°”',13:'ì‚¬'};
const yKor={13:'ê°€',14:'ë‚˜',15:'ë‹¤',16:'ë¼',17:'ë§ˆ',18:'ë°”',19:'ì‚¬',20:'ì•„'};
const xKorR=Object.fromEntries(Object.entries(xKor).map(([k,v])=>[v,+k]));
const yKorR=Object.fromEntries(Object.entries(yKor).map(([k,v])=>[v,+k]));

/* ìœ í‹¸ */
function toDMS(d){
  const D=Math.floor(d);
  const M=Math.floor((d-D)*60);
  const S=(((d-D)*60-M)*60).toFixed(2);
  return `${D}Â° ${M}â€² ${S}â€³`;
}

/* ì§€ë„ */
let map,marker;
function showMap(lat,lon){
  const p=new kakao.maps.LatLng(lat,lon);
  map=new kakao.maps.Map(document.getElementById("map"),{center:p,level:3});
  marker=new kakao.maps.Marker({position:p});
  marker.setMap(map);
}

/* ë©”ì¸ ë³€í™˜ */
function convert(){
  const v=document.getElementById("input").value.trim();
  let lat,lon;

  /* êµ­ê°€ì§€ì ë²ˆí˜¸ */
  if(/[ê°€-ì•„]/.test(v)){
    const m=v.match(/([ê°€-ì•„])\s*(\d+)\s*([ê°€-ì•„])\s*(\d+)/);
    if(!m){alert("êµ­ê°€ì§€ì ë²ˆí˜¸ í˜•ì‹ ì˜¤ë¥˜");return;}

    const x=xKorR[m[1]]*100000+Number(m[2]);
    const y=yKorR[m[3]]*100000+Number(m[4]);
    [lon,lat]=proj4("EPSG:5179","WGS84",[x,y]);
  }
  /* ë„ë¶„ì´ˆ */
  else if(v.includes(" ")){
    const p=v.split(/[ ,]+/).map(Number);
    lat=p[0]+p[1]/60+p[2]/3600;
    lon=p[3]+p[4]/60+p[5]/3600;
  }
  /* ë„ì¢Œí‘œ */
  else{
    [lat,lon]=v.split(/[ ,]+/).map(Number);
  }

  if(isNaN(lat)||isNaN(lon)){alert("ì¢Œí‘œ ì¸ì‹ ì‹¤íŒ¨");return;}

  const utm=proj4("WGS84","EPSG:5179",[lon,lat]);
  const x=Math.floor(utm[0]),y=Math.floor(utm[1]);

  document.getElementById("result").textContent=
`ğŸ“Œ WGS84
DD : ${lat.toFixed(6)}, ${lon.toFixed(6)}
DMS: ${toDMS(lat)} / ${toDMS(lon)}

ğŸ§­ UTM-K
E ${x}
N ${y}

ğŸ”ï¸ êµ­ê°€ì§€ì ë²ˆí˜¸
${xKor[Math.floor(x/100000)]} ${x%100000}
${yKor[Math.floor(y/100000)]} ${y%100000}`;

  showMap(lat,lon);
}

/* ë³µì‚¬ / ê³µìœ  */
function copyResult(){
  navigator.clipboard.writeText(result.textContent);
  alert("ë³µì‚¬ ì™„ë£Œ");
}
function shareResult(){
  navigator.share
   ? navigator.share({title:"í˜„ì¥ ì¢Œí‘œ",text:result.textContent})
   : copyResult();
}
</script>

</body>
</html>
