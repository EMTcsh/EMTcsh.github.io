<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ì‘ê¸‰êµ¬ì¡°ì‚¬ êµ¬ê¸‰í™œë™ì¼ì§€</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @media print {
      .no-print { display: none !important; }
      body { background: white; }
    }
    .field-label { min-width: 5rem; font-weight: bold; }
  </style>
</head>
<body class="bg-gray-100 p-4">
  <div class="max-w-4xl mx-auto bg-white shadow-lg rounded-xl p-6 space-y-6">

    <h1 class="text-2xl font-bold text-center mb-4">ğŸš‘ êµ¬ê¸‰í™œë™ì¼ì§€</h1>

    <!-- í™˜ìì •ë³´ -->
    <section>
      <h2 class="text-xl font-semibold mb-2">í™˜ì ì •ë³´</h2>
      <div class="grid grid-cols-2 gap-4">
        <input type="text" placeholder="ì„±ëª…" class="border p-2 rounded w-full" id="p_name">
        <input type="text" placeholder="ì„±ë³„" class="border p-2 rounded w-full" id="p_gender">
        <input type="text" placeholder="ì—°ë ¹" class="border p-2 rounded w-full" id="p_age">
        <input type="text" placeholder="ì—°ë½ì²˜" class="border p-2 rounded w-full" id="p_phone">
      </div>
    </section>

    <!-- í™œë ¥ì§•í›„ -->
    <section>
      <h2 class="text-xl font-semibold mb-2">í™œë ¥ì§•í›„</h2>
      <div id="vitalContainer" class="space-y-2">
        <div class="grid grid-cols-6 gap-2">
          <input type="text" placeholder="í˜ˆì••" class="border p-2 rounded v_bp">
          <input type="text" placeholder="ë§¥ë°•" class="border p-2 rounded v_hr">
          <input type="text" placeholder="í˜¸í¡ìˆ˜" class="border p-2 rounded v_rr">
          <input type="text" placeholder="SpOâ‚‚" class="border p-2 rounded v_spO2">
          <input type="text" placeholder="GCS" class="border p-2 rounded v_gcs">
          <input type="text" placeholder="í˜ˆë‹¹" class="border p-2 rounded v_bloodSugar">
        </div>
      </div>
      <button onclick="addVital()" class="mt-2 bg-blue-500 text-white px-3 py-1 rounded">+ ì¶”ê°€</button>
    </section>

    <!-- ì²˜ì¹˜Â·ì¥ë¹„ -->
    <section>
      <h2 class="text-xl font-semibold mb-2">ì²˜ì¹˜Â·ì¥ë¹„</h2>
      <div id="treatmentContainer" class="space-y-2">
        <div class="grid grid-cols-3 gap-2">
          <input type="text" placeholder="ì²˜ì¹˜ë‚´ìš©" class="border p-2 rounded treatment">
          <input type="text" placeholder="ì‚¬ìš©ì¥ë¹„" class="border p-2 rounded equipment">
          <input type="text" placeholder="ë¹„ê³ " class="border p-2 rounded note">
        </div>
      </div>
      <button onclick="addTreatment()" class="mt-2 bg-green-500 text-white px-3 py-1 rounded">+ ì¶”ê°€</button>
    </section>

    <!-- ë²„íŠ¼ -->
    <div class="flex justify-center space-x-4 no-print">
      <button onclick="saveData()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg shadow">ì €ì¥/ì „ì†¡</button>
      <button onclick="window.print()" class="bg-gray-500 text-white px-4 py-2 rounded-lg shadow">ì¶œë ¥</button>
    </div>
  </div>

  <script>
    // í™œë ¥ì§•í›„ ì¶”ê°€
    function addVital() {
      const div = document.createElement("div");
      div.className = "grid grid-cols-6 gap-2";
      div.innerHTML = `
        <input type="text" placeholder="í˜ˆì••" class="border p-2 rounded v_bp">
        <input type="text" placeholder="ë§¥ë°•" class="border p-2 rounded v_hr">
        <input type="text" placeholder="í˜¸í¡ìˆ˜" class="border p-2 rounded v_rr">
        <input type="text" placeholder="SpOâ‚‚" class="border p-2 rounded v_spO2">
        <input type="text" placeholder="GCS" class="border p-2 rounded v_gcs">
        <input type="text" placeholder="í˜ˆë‹¹" class="border p-2 rounded v_bloodSugar">
      `;
      document.getElementById("vitalContainer").appendChild(div);
    }

    // ì²˜ì¹˜/ì¥ë¹„ ì¶”ê°€
    function addTreatment() {
      const div = document.createElement("div");
      div.className = "grid grid-cols-3 gap-2";
      div.innerHTML = `
        <input type="text" placeholder="ì²˜ì¹˜ë‚´ìš©" class="border p-2 rounded treatment">
        <input type="text" placeholder="ì‚¬ìš©ì¥ë¹„" class="border p-2 rounded equipment">
        <input type="text" placeholder="ë¹„ê³ " class="border p-2 rounded note">
      `;
      document.getElementById("treatmentContainer").appendChild(div);
    }

    // ë°ì´í„° ì €ì¥ (Google Sheetsë¡œ ì „ì†¡)
    function saveData() {
      const data = {
        patient: {
          name: document.getElementById("p_name").value,
          gender: document.getElementById("p_gender").value,
          age: document.getElementById("p_age").value,
          phone: document.getElementById("p_phone").value,
        },
        vitals: [],
        treatments: []
      };

      document.querySelectorAll("#vitalContainer > div").forEach(row => {
        data.vitals.push({
          bp: row.querySelector(".v_bp").value,
          hr: row.querySelector(".v_hr").value,
          rr: row.querySelector(".v_rr").value,
          spO2: row.querySelector(".v_spO2").value,
          gcs: row.querySelector(".v_gcs").value,
          bloodSugar: row.querySelector(".v_bloodSugar").value,
        });
      });

      document.querySelectorAll("#treatmentContainer > div").forEach(row => {
        data.treatments.push({
          treatment: row.querySelector(".treatment").value,
          equipment: row.querySelector(".equipment").value,
          note: row.querySelector(".note").value,
        });
      });

      const url = "https://script.google.com/macros/s/AKfycbwoukv-YGDe0zapkyipf9oSObecU8bJr4JAyHregzOyWb-mp9rQTioTbtCpTmY4MhyYZQ/exec"; // ğŸ”¹ Apps Script ë°°í¬ URL ë„£ê¸°

      fetch(url, {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      })
      .then(() => alert("ì „ì†¡ ì™„ë£Œ!"))
      .catch(err => alert("ì „ì†¡ ì‹¤íŒ¨: " + err));
    }
  </script>
</body>
</html>

