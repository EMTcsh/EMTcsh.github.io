<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ğŸ†˜ êµ¬ì¡°ìš”ì²­</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- ì¹´ì¹´ì˜¤ ì§€ë„ API -->
<script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=ff9e145029506d6e4c72d1f2b01ea424&libraries=services"></script>

<style>
body {
    margin:0;
    font-family: Arial, sans-serif;
    background:#f5f5f5;
}
header {
    background:#b71c1c;
    color:white;
    padding:14px;
    text-align:center;
    font-size:20px;
}
#map {
    width:100%;
    height:300px;
}
section {
    padding:15px;
}
.info {
    background:white;
    padding:12px;
    border-radius:6px;
    margin-bottom:10px;
}
input, textarea, button {
    width:100%;
    padding:10px;
    margin-top:8px;
    font-size:16px;
}
textarea { resize:vertical; }
button {
    background:#d32f2f;
    color:white;
    border:none;
    border-radius:6px;
    cursor:pointer;
    font-size:18px;
}
.small {
    font-size:14px;
    color:#555;
}
</style>
</head>
<body>

<header>ğŸ†˜ êµ¬ì¡°ìš”ì²­</header>

<div id="map"></div>

<section>
    <div class="info" id="gpsInfo">ğŸ“ ìœ„ì¹˜ í™•ì¸ ì¤‘...</div>

    <div class="info">
        <b>â˜ï¸ ì—°ë½ ë°›ì„ ì „í™”ë²ˆí˜¸</b>
        <input id="phone" value="0622271187" placeholder="ì „í™”ë²ˆí˜¸ (ìˆ«ìë§Œ)">
    </div>

    <div class="info">
        <b>ğŸ‘¤ í™˜ì ì •ë³´</b>
        <input id="name" placeholder="ì´ë¦„ (ë¯¸ìƒ ê°€ëŠ¥)">
        <input id="age" placeholder="ë‚˜ì´ / ì„±ë³„">
        <textarea id="condition" placeholder="ì¦ìƒ ë° ìƒí™© (ì˜ˆ: ì¶”ë½ í›„ ì˜ì‹ì €í•˜)"></textarea>
    </div>

    <button onclick="sendSMSAndCall()">âœ‰ï¸ ë¬¸ì ì „ì†¡ í›„ â˜ï¸ ì „í™” ì—°ê²°</button>
    <div class="small">
        â€» ë¬´ë“±ì‚°êµ­ë¦½ê³µì› íŠ¹ìˆ˜êµ¬ì¡°ëŒ€ë¡œ ë¬¸ì ì‘ì„± í›„ ì „í™”ê°€ ì—°ê²°ë©ë‹ˆë‹¤
    </div>
</section>

<script>
let map, marker;
let lat = null, lng = null;

// ì§€ë„ ì´ˆê¸°í™”
function initMap(latInit = 37.5665, lngInit = 126.9780) {
    map = new kakao.maps.Map(document.getElementById("map"), {
        center: new kakao.maps.LatLng(latInit, lngInit),
        level: 3
    });
    marker = new kakao.maps.Marker({ map: map });
}
initMap();

// ì‹¤ì‹œê°„ ìœ„ì¹˜ ê°±ì‹ 
navigator.geolocation.watchPosition(
    pos => {
        lat = pos.coords.latitude;
        lng = pos.coords.longitude;

        const loc = new kakao.maps.LatLng(lat, lng);
        map.setCenter(loc);
        marker.setPosition(loc);

        document.getElementById("gpsInfo").innerHTML = `
            ğŸ“ ìœ„ë„: ${lat.toFixed(6)}<br>
            ğŸ“ ê²½ë„: ${lng.toFixed(6)}
        `;
    },
    () => alert("ìœ„ì¹˜ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤."),
    { enableHighAccuracy:true, maximumAge:0, timeout:5000 }
);

// ë¬¸ì + ì „í™”
function sendSMSAndCall() {
    if (lat === null || lng === null) {
        alert("ìœ„ì¹˜ í™•ì¸ ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.");
        return;
    }

    const phone = document.getElementById("phone").value.replace(/[^0-9]/g, "");
    if (!phone) {
        alert("ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
        return;
    }

    const name = document.getElementById("name").value || "ë¯¸ìƒ";
    const age = document.getElementById("age").value || "-";
    const condition = document.getElementById("condition").value || "-";

    const message =
`[êµ¬ì¡°ìš”ì²­]
ìœ„ë„: ${lat.toFixed(6)}
ê²½ë„: ${lng.toFixed(6)}

í™˜ì: ${name}
ë‚˜ì´/ì„±ë³„: ${age}
ì¦ìƒ: ${condition}`;

    // 1ï¸âƒ£ ë¬¸ì ì•± ì—´ê¸° (ë‚´ìš© ìë™ ì…ë ¥)
    location.href = `sms:${phone}?body=${encodeURIComponent(message)}`;

    // 2ï¸âƒ£ ì ì‹œ í›„ ì „í™” ì—°ê²°
    setTimeout(() => {
        location.href = `tel:${phone}`;
    }, 1200);
}
</script>

</body>
</html>

